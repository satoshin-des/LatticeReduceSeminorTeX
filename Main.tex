\RequirePackage{plautopatch}
\documentclass[12pt,aspectratio=169,xcolor=dvipsnames,table,dvipdfmx, leqno]{beamer}

\usepackage{bxdpx-beamer}
\usepackage{mathtools}
\usepackage{amsmath,amsthm,amssymb,amscd}
\usepackage{ascmac}
\usepackage{physics}
\usepackage{here}
\usepackage{url}
\usepackage{bm}
\usepackage{subcaption}
\usepackage{color}
\usepackage{multirow}
\usepackage[all]{xy}
\usepackage[T1]{fontenc}
\usepackage{newtxtext} % 数式以外をTXフォントで上書き
\usepackage{ulem}
\usepackage[deluxe,uplatex]{otf} % 日本語多ウェイト化
%\usepackage[linesnumbered,ruled]{algorithm2e}
\usepackage{algorithm}
\usepackage[noend]{algpseudocode}
\usepackage{tikz}


%Beamerの設定
\usetheme{Boadilla}

%Beamerフォント設定
\usefonttheme{professionalfonts} % Be professional!
\renewcommand{\familydefault}{\sfdefault}  % 英文をサンセリフ体に
\renewcommand{\kanjifamilydefault}{\gtdefault}  % 日本語をゴシック体に
\renewcommand{\Comment}[1]{\quad/*#1*/}
\newcommand{\vol}{\text{vol}}
\newcommand{\round}[1]{\left\lfloor #1 \right\rceil}
\newcommand{\bhline}{\noalign{\hrule height 1.0pt}}
\DeclareMathOperator{\Pot}{Pot}
\DeclareFontFamily{U}{mathx}{}
\DeclareFontShape{U}{mathx}{m}{n}{<-> mathx10}{}
\DeclareSymbolFont{mathx}{U}{mathx}{m}{n}
\DeclareMathAccent{\widecheck}{0}{mathx}{"71}

\algdef{SE}[DOWHILE]{Do}{doWhile}{\algorithmicdo}[1]{\algorithmicwhile\ #1}%

% Babel (日本語の場合のみ・英語の場合は不要)
\uselanguage{japanese}
\languagepath{japanese}
\deftranslation[to=japanese]{Theorem}{定理}
\deftranslation[to=japanese]{Lemma}{補題}
\deftranslation[to=japanese]{Example}{例}
\deftranslation[to=japanese]{Examples}{例}
\deftranslation[to=japanese]{Definition}{定義}
\deftranslation[to=japanese]{Definitions}{定義}
\deftranslation[to=japanese]{Problem}{問題}
\deftranslation[to=japanese]{Solution}{解}
\deftranslation[to=japanese]{Fact}{事実}
\deftranslation[to=japanese]{Proof}{証明}
\def\proofname{証明}

\setbeamertemplate{theorems}[numbered]
\newtheorem{Proposition}[theorem]{命題}

%タイトル
\title[勉強会]{勉強会形式ゼミ資料①\\P.Q.Nguyen and D. Stehle Floating-Point LLL Revisited}
\author[佐藤]{佐藤 新}
\date{\today}
%\institute[]{\inst{1}~立教大学}

\begin{document}
\maketitle

\begin{frame}
    本セミナーで用いられる記号など
    \begin{itemize}
        \item 全て$\{\bm{b}_1,\ldots,\bm{b}_n\}$を基底としてもつ整数格子
        \item $B=\max\{\norm{b}_i~|~1\le i\le n\}$
        \item 浮動小数点数の演算精度は$\ell$-bit
    \end{itemize}
\end{frame}

\begin{frame}{Gram-Schmidtの計算}
    Gram-Schmidtの情報は
    \[
    \mu_{i, j}=\frac{\langle \bm{b}_i, \bm{b}_j\rangle-\sum_{k=1}^{j-1}\mu_{j, k}\mu_{i, k}\norm{\bm{b}_k^\star}^2}{\norm{\bm{b}_j^\star}^2}, \norm{\bm{b}_i^\star}^2=\norm{\bm{b}_i^\star}^2-\sum_{j=1}^{i-1}\mu_{i, j}^2\norm{\bm{b}_j^\star}^2
    \]
    という公式で計算可能

    \begin{itemize}
        \item 内積$\langle \bm{b}_i, \bm{b}_j\rangle$の計算に浮動小数点数（fpa）が必要\\
        \quad\quad $2^{-\ell}\norm{\bm{b}_i}\norm{\bm{b}_j}$の潜在的な不確定性がある
    \end{itemize}
\end{frame}

\begin{frame}{Gram-Schmidtの計算}
    Gram-Schmidtの情報から
    \[
    r_{i, j}=\langle \bm{b}_i, \bm{b}_j\rangle-\sum_{k=1}^{j-1}\mu_{j, k}r_{i, k},~\mu_{i, j}=\frac{r_{i, j}}{r_{j, j}}\quad(i\ge j)
    \]
    という公式で計算可能な形で情報を持つ\\
    $\quad\quad\rightsquigarrow$精度が改善される
    \begin{itemize}
        \item 内積はGram行列から得られる（fpa）である必要なし
        \item 乗算が\underline{\textbf{2回から1回}}に
    \end{itemize}
\end{frame}

\begin{frame}{Gram-Schmidtの計算}
\[
s_j^{(i)}\coloneqq \norm{\bm{b}_i}^2-\sum_{k=1}^{j-1}\mu_{i, k}r_{i, k}\left(=\sum_{k=j}^i\mu_{i, k}r_{i, k}\right)\quad(1\le j\le i)
\]
とすると，Lov\'asz条件$\delta\norm{\bm{b}_{\kappa-1}^\star}^2\le \norm{\bm{b}_\kappa^\star}^2+\mu_{\kappa, \kappa-1}^2\norm{\bm{b}_{\kappa-1}^\star}^2$は
\[
\delta r_{\kappa-1, \kappa-1}\le s_{\kappa-1}^{(\kappa)}
\]
と書き換えることができる．
更に$\bm{b}_{\kappa}$と$\bm{b}_{\kappa-1}$の交換後はLov\'asz条件は
\[
\delta r_{\kappa-2, \kappa-2}\le s_{\kappa-2}^{(\kappa)}
\]
になるので，\textbf{追加のコストなく}次の条件に移れる
\end{frame}

\begin{frame}{}
\begin{algorithm}[H]
    \footnotesize
    \begin{algorithmic}[1]
        \caption{\footnotesize $L^2$内でのsize-reduction}
        \label{alg_LLL}
        \Require{パラメタ$\eta>1/2$，$\kappa\in\mathbb{Z}$，基底$\{\bm{b}_1,\ldots, \bm{b}_n\}$}
        \Ensure{$[\bar{r}_{\kappa, j}],~[\bar{\mu}_{\kappa, j}],~[\bar{s}_j]~(j\le \kappa)$，$\{\ldots,\bm{b}_{\kappa-1},\bm{b}_{\kappa}',\bm{b}_{\kappa+1},\ldots\}$}
        \State $\bar{\eta}\gets\frac{\eta+1/2}{2}=\frac{2\eta+1}{4}$
        \Do
            \For{$j=1$ to $\kappa$}\Comment{Cholesky分解}
                \State $\bar{r}_{i, j}\gets \langle\bm{b}_i, \bm{b}_j\rangle$
                \State \textbf{for} $k=1$ to $j-1$ \textbf{do} $\bar{r}_{i, j}\gets \bar{r}_{i, j}-\bar{r}_{i, k}\bar{\mu}_{j, k}$
                \State $\bar{\mu}_{i, j}\gets {\bar{r}_{i, j}}/{\bar{r}_{j, j}}$
            \EndFor
            \State $s_0\gets \norm{\bm{b}_n}^2$
            \State \textbf{for} $k = 1$ to $j-1$ \textbf{do} $\bar{s}_j\gets \bar{s}_{j-1}-\bar{\mu}_{n, j}\bar{r}_{n, j}$
            \State $r_{n, n}\gets s_n$
            \For{$i=\kappa-1$ downto 1}
                \State \textbf{if} $\abs{\bar{\mu}_{k, i}}\ge \bar{\eta}$ \textbf{then} $X_i\gets \round{\bar{\mu}_{k, i}}$ \textbf{else} $X_i\gets 0$
                \State \textbf{for} $j=1$ to $i-1$ \textbf{do} $\bar{\mu}_{k, j}\gets \bar{\mu}_{\kappa, j}-X_i\bar{\mu}_{i, j}$
            \EndFor
            \State $\bm{b}_\kappa\gets \bm{b}_\kappa-\sum_{i=1}^{\kappa-1}X_i\bm{b}_i$
        \doWhile{$X\ne \bm{0}_{\kappa-1}$}
    \end{algorithmic}
\end{algorithm}
\end{frame}

\begin{frame}[allowframebreaks]{参考文献}
\beamertemplatetextbibitems
\bibliographystyle{plain}
\bibliography{ref}
\end{frame}
\end{document}